<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Come Mangonio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body{
        margin:0;
        padding:0;
        background:#000;
        color:#fff;
        font-family:Arial, sans-serif;
        display:flex;
        justify-content:center;
        align-items:center;
        height:100vh;
    }

    .container{
        width:90%;
        max-width:1200px;
        display:flex;
        gap:20px;
    }

    /* Panel del juego */
    #gameCanvas{
        background:#2ea043;
        border-radius:10px;
        flex:2;
        display:block;
        box-shadow:0 0 20px rgba(0,0,0,0.6);
    }

    /* Panel derecho */
    .panel{
        flex:1;
        background:#111;
        padding:20px;
        border-radius:10px;
        color:#fff;
        box-shadow:0 0 20px rgba(0,0,0,0.6);
        display:flex;
        flex-direction:column;
        gap:20px;
    }

    h1{
        margin:0 0 5px 0;
        font-size:28px;
        color:#fff;
    }

    .score{
        font-size:32px;
        font-weight:bold;
        color:#ffdd55;
    }

    button{
        padding:10px 15px;
        border:none;
        background:#ffdd55;
        color:#000;
        border-radius:8px;
        cursor:pointer;
        font-size:16px;
        transition:0.2s;
    }

    button:hover{
        background:#ffe784;
    }

    .instructions{
        background:#222;
        padding:15px;
        border-radius:8px;
        color:#fff;
        font-size:14px;
        line-height:1.5;
    }
</style>
</head>

<body>

<div class="container">

    <canvas id="gameCanvas" width="800" height="500"></canvas>

    <div class="panel">
        <h1>Come Mangonio</h1>

        <div>
            <div>Puntuación</div>
            <div class="score" id="score">0</div>
        </div>

        <button onclick="resetGame()">Reiniciar</button>

        <div class="instructions">
            Muévete con las flechas o WASD.<br>
            Come la comida para crecer.<br>
            Si tocas un muro o tu propio cuerpo pierdes.
        </div>
    </div>

</div>

<script>
/* CONFIGURACIÓN */
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const tile = 20;
const cols = canvas.width / tile;
const rows = canvas.height / tile;

let snake, direction, food, score, mangonioHead;

/* CARGAR CABEZA MANGONIO */
mangonioHead = new Image();
mangonioHead.src = "Mangonio.png"; // Debe estar en la misma carpeta

/* REINICIO */
function resetGame() {
    snake = [
        { x: 5, y: 5 }
    ];
    direction = { x: 1, y: 0 };
    score = 0;
    document.getElementById("score").innerText = score;

    placeFood();
}
resetGame();

/* COMIDA */
function placeFood() {
    food = {
        x: Math.floor(Math.random() * cols),
        y: Math.floor(Math.random() * rows)
    };
}

/* INPUT */
document.addEventListener("keydown", e => {
    if (e.key === "ArrowUp" || e.key.toLowerCase() === "w") direction = {x:0,y:-1};
    if (e.key === "ArrowDown" || e.key.toLowerCase() === "s") direction = {x:0,y:1};
    if (e.key === "ArrowLeft" || e.key.toLowerCase() === "a") direction = {x:-1,y:0};
    if (e.key === "ArrowRight" || e.key.toLowerCase() === "d") direction = {x:1,y:0};
});

/* LOOP 60 FPS */
let lastTime = 0;
const speed = 1000 / 10; // movimiento 10 veces por segundo (rápido y suave)

function gameLoop(timestamp) {
    requestAnimationFrame(gameLoop);

    if (timestamp - lastTime < speed) return;
    lastTime = timestamp;

    update();
    draw();
}
requestAnimationFrame(gameLoop);

/* LÓGICA */
function update() {
    // mover snake
    const head = {
        x: snake[0].x + direction.x,
        y: snake[0].y + direction.y
    };

    // muerte por bordes
    if (head.x < 0 || head.x >= cols || head.y < 0 || head.y >= rows) {
        resetGame();
        return;
    }

    // muerte por tocarte
    for (let part of snake) {
        if (part.x === head.x && part.y === head.y) {
            resetGame();
            return;
        }
    }

    snake.unshift(head);

    // comer
    if (head.x === food.x && head.y === food.y) {
        score += 10;
        document.getElementById("score").innerText = score;
        placeFood();
    } else {
        snake.pop();
    }
}

/* DIBUJADO */
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // comida
    ctx.fillStyle = "#ff5555";
    ctx.beginPath();
    ctx.arc(food.x * tile + tile/2, food.y * tile + tile/2, tile/2, 0, Math.PI * 2);
    ctx.fill();

    // cuerpo
    ctx.fillStyle = "#ffe66d"; // amarillo suave
    for (let i = 1; i < snake.length; i++) {
        ctx.beginPath();
        ctx.roundRect(
            snake[i].x * tile + 3,
            snake[i].y * tile + 3,
            tile - 6,
            tile - 6,
            6
        );
        ctx.fill();
    }

    // cabeza (Mangonio.png)
    const head = snake[0];
    ctx.drawImage(
        mangonioHead,
        head.x * tile,
        head.y * tile,
        tile,
        tile
    );
}
</script>

</body>
</html>
