<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Come Mangonio</title>
<style>
  :root{
    --panel-bg:#000;
    --panel-contrast:#111;
    --muted:#8d8d8d;
    --accent:#ffd83b;
  }

  body{
    margin:0;
    background:#000;
    font-family:Arial, sans-serif;
    color:white;
    display:flex;
    justify-content:center;
    padding:20px;
  }

  .wrap{
    width:1100px;
    max-width:100%;
    display:grid;
    grid-template-columns: 1fr 300px;
    gap:20px;
  }

  header{
    grid-column:1/-1;
    display:flex;
    align-items:center;
    gap:12px;
    margin-bottom:6px;
  }

  header img{
    width:50px;height:50px;
    border-radius:10px;
    object-fit:cover;
  }

  h1{margin:0;font-size:22px}
  .sub{color:var(--muted)}

  canvas{
    display:block;
    width:100%;
    height:auto;
    border-radius:10px;
    background:#000;
  }

  .panel{
    background:var(--panel-bg);
    border-radius:12px;
    padding:14px;
    display:flex;
    flex-direction:column;
    gap:12px;
  }

  .score{
    font-size:32px;
    color:var(--accent);
    font-weight:bold;
  }

  button{
    background:var(--accent);
    border:none;
    padding:8px 10px;
    font-weight:bold;
    border-radius:8px;
    cursor:pointer;
  }

  .instructions{
    background:var(--panel-contrast);
    padding:10px;
    border-radius:10px;
    color:#ccc;
    font-size:14px;
  }

  @media(max-width:900px){
    .wrap{
      grid-template-columns:1fr;
    }
  }
</style>
</head>
<body>

<div class="wrap">

  <header>
    <img src="mangonio.png" onerror="this.style.display='none'">
    <div>
      <h1>Come Mangonio</h1>
      <div class="sub">Versi√≥n 60 FPS</div>
    </div>
  </header>

  <canvas id="game" width="900" height="600"></canvas>

  <aside class="panel">
    <div>
      <div style="color:#777;font-size:14px">Puntuaci√≥n</div>
      <div id="score" class="score">0</div>
    </div>

    <button id="btnRestart">Reiniciar</button>
    <button id="btnPause">Pausa</button>

    <div class="instructions">
      Usa WASD o flechas para moverte.<br>
      Come manzanas para crecer.<br>
      Si chocas el borde o tu cuerpo, pierdes.
    </div>
  </aside>

</div>

<script>
/* ========== CONFIGURACI√ìN ========== */

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const COLS = 23;
const ROWS = 15;
const CELL = 36;

canvas.width = COLS * CELL;
canvas.height = ROWS * CELL;

let snake = [];
let direction = "right";
let nextDirection = "right";
let food = null;
let gameInterval = null;
let paused = false;
let score = 0;

/* üî• VELOCIDAD ‚Äî M√ÅS LENTO (ANTES 100ms, AHORA 180ms) */
let speed = 300; // lento

/* ========== FUNCIONES ========== */

function init(){
  snake = [
    {x:5, y:7},
    {x:4, y:7},
    {x:3, y:7}
  ];
  direction = "right";
  nextDirection = "right";
  score = 0;
  document.getElementById("score").textContent = score;

  placeFood();
  startLoop();
}

function startLoop(){
  clearInterval(gameInterval);
  gameInterval = setInterval(gameLoop, speed);
}

function placeFood(){
  food = {
    x: Math.floor(Math.random()*COLS),
    y: Math.floor(Math.random()*ROWS)
  };
}

function gameLoop(){
  if(paused) return;

  direction = nextDirection;
  moveSnake();
  draw();
}

function moveSnake(){
  let head = {...snake[0]};

  if(direction === "up") head.y--;
  if(direction === "down") head.y++;
  if(direction === "left") head.x--;
  if(direction === "right") head.x++;

  // colisi√≥n con paredes
  if(head.x < 0 || head.x >= COLS || head.y < 0 || head.y >= ROWS){
    restart();
    return;
  }

  // colisi√≥n con el cuerpo
  if(snake.some(p => p.x === head.x && p.y === head.y)){
    restart();
    return;
  }

  snake.unshift(head);

  // comer
  if(head.x === food.x && head.y === food.y){
    score++;
    document.getElementById("score").textContent = score;
    placeFood();
  } else {
    snake.pop();
  }
}

function draw(){
  ctx.fillStyle = "#000";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // serpiente
  ctx.fillStyle = "#31ff48";
  snake.forEach(p => {
    ctx.fillRect(p.x*CELL, p.y*CELL, CELL-2, CELL-2);
  });

  // comida
  ctx.fillStyle = "#ff3131";
  ctx.fillRect(food.x*CELL, food.y*CELL, CELL-2, CELL-2);
}

function restart(){
  init();
}

/* ========== CONTROLES ========== */

document.addEventListener("keydown", e => {
  if(e.key === "ArrowUp" || e.key === "w") if(direction !== "down") nextDirection = "up";
  if(e.key === "ArrowDown" || e.key === "s") if(direction !== "up") nextDirection = "down";
  if(e.key === "ArrowLeft" || e.key === "a") if(direction !== "right") nextDirection = "left";
  if(e.key === "ArrowRight" || e.key === "d") if(direction !== "left") nextDirection = "right";
});

document.getElementById("btnRestart").onclick = restart;

document.getElementById("btnPause").onclick = () => {
  paused = !paused;
};

/* INICIAR */
init();
</script>

</body>
</html>


